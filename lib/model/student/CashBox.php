<?php


/**
 * Skeleton subclass for representing a row from the 'sch_cashbox' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Fri Sep 28 00:21:32 2012
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model.student
 */
class CashBox extends BaseCashBox {

   /**
   * Cierra una auditoria
   * 
   * @param PropelPDO $con 
   */
  function Close($con = null)
  {
    $sfDate = new SfDate();
    
    $this->setIdState(2); // Cerrado
    $this->setClosingDate($sfDate->dump());
    $this->setComment('Cerrado por la Auditoria');
    $this->save($con);    
  }
  
  
  Public function getCashierName() {
     return $this->getsfGuardUser()->getUsername();
  }
  
  /**
   * Devuelve todas las monedas (Currency) que ha usado 
   * Esta caja
   * 
   * @return Currencys
   */
  function getAllCurrencys()
  {   
    return CashBoxPeer::getAllCurrencys($this->getId());
  }
  
  
  function getTotalCurrency($currency_id)
  {
    return CashBoxPeer::getTotalMovement($this->getId(), $currency_id, 1);  
  }
  
  public function getNameState()
  {
     $r = '';
     switch ($this->getIdState())
     {
	case 1:
	   $r = 'Abierta';
	   break;
	case 2:
	   $r = 'Cerrada';
	   break;
	case 3:
	   $r = 'Observada';
	   break;
     }
     
     return $r;
  }
  
} // CashBox
