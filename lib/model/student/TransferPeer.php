<?php


/**
 * Skeleton subclass for performing query and update operations on the 'sch_transfer' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Thu Dec  6 04:53:20 2012
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model.student
 */
class TransferPeer extends BaseTransferPeer {

   public static function saveTransfer($id_state, $amount, $comment, $type, $sf_guard_user_id, $transfer = null, $con = null)
   {
      if(!is_object($transfer))
      {
	 $transfer = new Transfer();
      }
      
      $transfer->setIdState($id_state);
      $transfer->setAmount($amount);      
      $transfer->setComment($comment);      
      $transfer->setType($type);      
      $transfer->setUserId($sf_guard_user_id);      
      $transfer->save($con);
      
      return $transfer;
   }
   
   public static function getCashierByTransfer($transfer_id)
   {
      $criteria = new Criteria();
      $criteria->addJoin(self::ID, MovementCashboxTransferPeer::TRANSFER_ID);
      $criteria->addJoin(MovementCashboxTransferPeer::MOVEMENT_CASHBOX_ID, MovementCashboxPeer::ID);
      $criteria->addJoin(MovementCashboxPeer::CASHBOX_ID, CashBoxPeer::ID); 
      $criteria->add(self::ID, $transfer_id);
      
      return CashboxPeer::doSelectOne($criteria);
   }
   
   
   public static function getNameCashier($transfer_id)
   {
      $cashbox = self::getCashierByTransfer($transfer_id);
 
      return $cashbox->getsfGuardUser()->getUserName();
   }
   
   public static function getCurrencyByMovement($transfer_id)
   {
      $criteria = new Criteria();
      
      $criteria->addJoin(self::ID, MovementCashboxTransferPeer::TRANSFER_ID);
      $criteria->addJoin(MovementCashboxTransferPeer::MOVEMENT_CASHBOX_ID, MovementCashboxPeer::ID);
      $criteria->add(MovementCashboxTransferPeer::TRANSFER_ID, $transfer_id);
      
      return MovementCashboxPeer::doSelectOne($criteria);
   }
   
   
} // TransferPeer
